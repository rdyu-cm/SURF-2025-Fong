log nvt.log
#==============
# Parameters
#==============

units           real
timestep 1.0
dimension 3
boundary p p p
atom_style      full
pair_style      lj/cut/coul/long 10.0 10.0
bond_style      harmonic
angle_style     harmonic
dihedral_style  opls 
neigh_modify every 1 delay 0 check yes # change no --> yes for nvt
pair_modify shift yes mix arithmetic
kspace_style pppm 1.0e-5

# read in coordinate file --> end of NPT run
read_restart run2.restart

# import non-bonded (LJ) interaction parameters
include "system.in.settings"

#run 0
#change_box all x final 0 {BOX_SIZE} y final 0 {BOX_SIZE} z final 0 {BOX_SIZE} remap units box

reset_timestep 0

#==============
# NVT run
#==============

variable t equal step
group gSPCE type  1  2
group cation type 3
group nitrate type 4 5
group WaterNitrate type 1 2 4 5

dump unwrapped all dcd 1000 nvt_unwrapped_$t.dcd 
dump_modify unwrapped unwrap yes 

# fix water bonds and angles of water and nitrate
fix fShake WaterNitrate shake 0.0001 100 0 b 1 2 a 1 2

# NVT ensemble
fix NVT all nvt temp 298 298 100.0

thermo_style custom time step temp press vol density pe ke etotal ecoul elong evdwl epair
thermo 1000
thermo_modify norm no flush yes

restart 1000 run1.restart run2.restart
run   1000000
write_dump all xyz final_nvt_structure.xyz 
write_data end_nvt.data