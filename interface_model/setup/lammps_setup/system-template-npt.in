log npt.log
#==============
# Parameters
#==============

units           real
timestep {TIMESTEP}
dimension 3
boundary p p p
atom_style      full
pair_style      lj/cut/coul/long {LJ_CUTOFF} {COUL_CUTOFF}
bond_style      harmonic
angle_style     harmonic
dihedral_style  opls 
neigh_modify every 1 delay 0 check no
pair_modify shift yes mix arithmetic
kspace_style pppm 1.0e-5

# read in coordinate file
read_data "system.data"

# import non-bonded (LJ) interaction parameters
include "system.in.settings"

#==============
# Energy minimization
#==============
group metal type 6
fix freeze metal setforce 0.0 0.0 0.0
dump minxyz all xyz 5 min_traj.xyz
dump_modify minxyz first yes

minimize 1.0e-5 1.0e-7 1000 10000

undump minxyz

reset_timestep 0



#==============
# NPT run
#==============

variable t equal step
velocity all create {TEMP} 12345
group gSPCE type  1  2
group cation type 3
group nitrate type 4 5
group WaterNitrate type 1 2 4 5

dump unwrapped all dcd 1000 npt_unwrapped_$t.dcd 
dump_modify unwrapped unwrap yes 

# fix water bonds and angles of water and nitrate
fix fShake WaterNitrate shake 0.0001 100 0 b 1 2 a 1 2
fix freeze metal setforce 0.0 0.0 0.0
group electrolyte subtract all metal
fix NPT electrolyte npt temp {TEMP} {TEMP} 100.0 z 1.0 1.0 1000.0 couple none

thermo_style custom time step temp press vol density pe ke etotal ecoul elong evdwl epair
thermo 1000
thermo_modify norm no flush yes

restart 1000 run1.restart run2.restart

dump npt all xyz 1000 npt_traj.xyz
dump_modify npt first yes

write_dump all xyz initial_structure.xyz 
run   {N_NPT_STEPS}
write_dump all xyz final_npt_structure.xyz 
write_data end_npt.data